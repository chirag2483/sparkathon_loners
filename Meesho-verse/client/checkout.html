<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wally-verse | Checkout</title>
  <link rel="stylesheet" href="css/checkout.css" />
</head>
<body>
  <header id="header" class="header">
    <nav class="nav container">
      <div class="logo">
        <a href="./index.html">
          <img src="assets/Images/walmart-logo.png" alt="Walmart Logo" />
        </a>
      </div>

      <div class="menu">
        <ul class="nav-list">
          <li class="nav-item">
            <a href="./tryon.html" class="nav-link">Virtual Tryon</a>
          </li>
          <li class="nav-item">
            <a href="./shop.html" class="nav-link">3D Shop</a>
          </li>
        </ul>
      </div>

      <button id="back-btn" class="back-button">‚Üê Back to Cart</button>
    </nav>
  </header>

  <main class="main container">
    <div class="checkout-container">
      <h1 class="checkout-title">üí≥ Secure Checkout</h1>
      
      <div class="checkout-content">
        <div class="checkout-form">
          <!-- Shipping Information -->
          <div class="form-section">
            <h2 class="section-title">
              <span class="icon">üìç</span>
              Shipping Information
            </h2>
            <div class="form-grid">
              <div class="form-group">
                <label for="firstName">First Name *</label>
                <input type="text" id="firstName" name="firstName" required>
              </div>
              <div class="form-group">
                <label for="lastName">Last Name *</label>
                <input type="text" id="lastName" name="lastName" required>
              </div>
              <div class="form-group full-width">
                <label for="email">Email Address *</label>
                <input type="email" id="email" name="email" required>
              </div>
              <div class="form-group full-width">
                <label for="phone">Phone Number *</label>
                <input type="tel" id="phone" name="phone" required>
              </div>
              <div class="form-group full-width">
                <label for="address">Street Address *</label>
                <input type="text" id="address" name="address" required>
              </div>
              <div class="form-group">
                <label for="city">City *</label>
                <input type="text" id="city" name="city" required>
              </div>
              <div class="form-group">
                <label for="state">State *</label>
                <input type="text" id="state" name="state" required>
              </div>
              <div class="form-group">
                <label for="zipCode">ZIP Code *</label>
                <input type="text" id="zipCode" name="zipCode" required>
              </div>
              <div class="form-group">
                <label for="country">Country *</label>
                <select id="country" name="country" required>
                  <option value="">Select Country</option>
                  <option value="IN" selected>India</option>
                  <option value="US">United States</option>
                  <option value="CA">Canada</option>
                  <option value="UK">United Kingdom</option>
                  <option value="AU">Australia</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Payment Information -->
          <div class="form-section">
            <h2 class="section-title">
              <span class="icon">üí≥</span>
              Payment Information
            </h2>
            
            <!-- Payment Method Selection -->
            <div class="payment-methods">
              <div class="payment-method">
                <input type="radio" id="card-payment" name="paymentMethod" value="card" checked>
                <label for="card-payment">
                  <div class="method-content">
                    <span class="method-icon">üí≥</span>
                    <span class="method-text">Credit/Debit Card</span>
                  </div>
                </label>
              </div>
              <div class="payment-method">
                <input type="radio" id="qr-payment" name="paymentMethod" value="qr">
                <label for="qr-payment">
                  <div class="method-content">
                    <span class="method-icon">üì±</span>
                    <span class="method-text">QR Code Payment</span>
                  </div>
                </label>
              </div>
            </div>

            <!-- Credit Card Form -->
            <div id="card-payment-form" class="payment-form">
              <div class="form-grid">
                <div class="form-group full-width">
                  <label for="cardNumber">Card Number *</label>
                  <div class="card-input">
                    <input type="text" id="cardNumber" name="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19">
                    <div class="card-icons">
                      <span class="card-icon">üí≥</span>
                      <span class="card-icon">üîí</span>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label for="expiryDate">Expiry Date *</label>
                  <input type="text" id="expiryDate" name="expiryDate" placeholder="MM/YY" maxlength="5">
                </div>
                <div class="form-group">
                  <label for="cvv">CVV *</label>
                  <input type="text" id="cvv" name="cvv" placeholder="123" maxlength="4">
                </div>
                <div class="form-group full-width">
                  <label for="cardName">Name on Card *</label>
                  <input type="text" id="cardName" name="cardName">
                </div>
              </div>
            </div>

            <!-- QR Payment Form -->
            <div id="qr-payment-form" class="payment-form" style="display: none;">
              <div class="qr-payment-content">
                <div class="qr-instructions">
                  <h4>Scan QR Code to Pay</h4>
                  <p>Use any UPI app (Google Pay, PhonePe, Paytm, etc.) to scan the QR code below and complete your payment.</p>
                </div>
                <div class="qr-code-container">
                  <img src="payment/QR.jpeg" alt="Payment QR Code" class="qr-code">
                  <div class="qr-overlay">
                    <span class="qr-amount">‚Çπ<span id="qr-amount">0</span></span>
                  </div>
                </div>
                <div class="qr-payment-status">
                  <div class="status-indicator">
                    <span class="status-icon">‚è≥</span>
                    <span class="status-text">Waiting for payment...</span>
                  </div>
                  <button type="button" id="check-payment-btn" class="check-payment-btn">
                    <span class="btn-icon">üîÑ</span>
                    Check Payment Status
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Shipping Options -->
          <div class="form-section">
            <h2 class="section-title">
              <span class="icon">üöö</span>
              Shipping Options
            </h2>
            <div class="shipping-options">
              <div class="shipping-option">
                <input type="radio" id="standard" name="shipping" value="standard" checked>
                <label for="standard">
                  <div class="option-content">
                    <div class="option-info">
                      <h4>Standard Delivery</h4>
                      <p>5-7 business days</p>
                    </div>
                    <div class="option-price">‚Çπ100</div>
                  </div>
                </label>
              </div>
              <div class="shipping-option">
                <input type="radio" id="express" name="shipping" value="express">
                <label for="express">
                  <div class="option-content">
                    <div class="option-info">
                      <h4>Express Delivery</h4>
                      <p>2-3 business days</p>
                    </div>
                    <div class="option-price">‚Çπ250</div>
                  </div>
                </label>
              </div>
              <div class="shipping-option">
                <input type="radio" id="overnight" name="shipping" value="overnight">
                <label for="overnight">
                  <div class="option-content">
                    <div class="option-info">
                      <h4>Overnight Delivery</h4>
                      <p>Next business day</p>
                    </div>
                    <div class="option-price">‚Çπ500</div>
                  </div>
                </label>
              </div>
            </div>
          </div>

          <!-- Order Notes -->
          <div class="form-section">
            <h2 class="section-title">
              <span class="icon">üìù</span>
              Order Notes (Optional)
            </h2>
            <div class="form-group full-width">
              <textarea id="orderNotes" name="orderNotes" placeholder="Add any special instructions or notes for your order..." rows="3"></textarea>
            </div>
          </div>
        </div>

        <!-- Order Summary -->
        <div class="order-summary">
          <h2 class="summary-title">Order Summary</h2>
          
          <div class="order-items" id="order-items">
            <!-- Order items will be dynamically loaded here -->
          </div>
          
          <div class="summary-details">
            <div class="summary-item">
              <span>Subtotal:</span>
              <span id="subtotal">‚Çπ0</span>
            </div>
            <div class="summary-item">
              <span>Tax (18%):</span>
              <span id="tax">‚Çπ0</span>
            </div>
            <div class="summary-item">
              <span>Shipping:</span>
              <span id="shipping">‚Çπ100</span>
            </div>
            <div class="summary-item total">
              <span>Total:</span>
              <span id="total">‚Çπ0</span>
            </div>
          </div>

          <div class="security-info">
            <div class="security-item">
              <span class="security-icon">üîí</span>
              <span>Secure SSL Encrypted</span>
            </div>
            <div class="security-item">
              <span class="security-icon">üõ°Ô∏è</span>
              <span>PCI DSS Compliant</span>
            </div>
            <div class="security-item">
              <span class="security-icon">‚úÖ</span>
              <span>100% Secure Checkout</span>
            </div>
          </div>

          <button id="place-order-btn" class="place-order-btn" disabled>
            <span class="btn-icon">üí≥</span>
            Place Order
          </button>

          <div class="terms-checkbox">
            <input type="checkbox" id="terms" name="terms" required>
            <label for="terms">
              I agree to the <a href="#" class="terms-link">Terms & Conditions</a> and <a href="#" class="terms-link">Privacy Policy</a>
            </label>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Loading Overlay -->
  <div id="loading-overlay" class="loading-overlay" style="display: none;">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <h3>Processing Your Order...</h3>
      <p>Please don't close this window</p>
    </div>
  </div>

  <script>
    // Get cart data
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    let shippingCost = 100;

    // Get product image based on product ID
    function getProductImage(productId) {
      const productImages = {
        '1': 'https://cdn.eyemyeye.com/shared/images/products/S12A2001/S12A2001-1.jpg',
        '2': 'https://assets.myntassets.com/h_720,q_90,w_540/v1/assets/images/30244568/2024/7/19/3dad10ad-79fb-4d76-a6dc-7742a687ba431721360472201HMMenPrintedResortShirts1.jpg',
        '3': 'https://rukminim2.flixcart.com/image/850/1000/xif0q/cap/t/7/b/free-latest-ny-baseball-cap-highever-original-imagnm8yxxvmhmdy.jpeg?q=90&crop=false',
        '4': 'https://assets.myntassets.com/h_720,q_90,w_540/v1/assets/images/2024/JULY/29/U2KRlrCA_f2a36048ad92464ba042c46e380dca67.jpg',
        '5': 'pants/Screenshot 2025-07-14 041652.png',
        '6': 'pants/Screenshot 2025-07-14 041742.png',
        '7': 'pants/Screenshot 2025-07-14 041754.png',
        '8': 'pants/Screenshot 2025-07-14 041807.png',
        '9': 'shirts/Screenshot 2025-07-14 041904.png',
        '10': 'shirts/Screenshot 2025-07-14 041916.png',
        '11': 'shirts/Screenshot 2025-07-14 041931.png',
        '12': 'shirts/Screenshot 2025-07-14 041941.png'
      };
      
      return productImages[productId] || 'https://via.placeholder.com/60x60/00b4d8/ffffff?text=Product';
    }

    // Update order summary
    function updateOrderSummary() {
      const orderItemsContainer = document.getElementById('order-items');
      const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
      const tax = subtotal * 0.18;
      const total = subtotal + tax + shippingCost;

      // Update order items
      orderItemsContainer.innerHTML = cart.map(item => `
        <div class="order-item">
          <div class="item-image">
            <img src="${getProductImage(item.id)}" alt="${item.name}" />
          </div>
          <div class="item-details">
            <h4 class="item-name">${item.name}</h4>
            <p class="item-quantity">Qty: ${item.quantity}</p>
          </div>
          <div class="item-price">‚Çπ${item.price * item.quantity}</div>
        </div>
      `).join('');

      // Update summary amounts
      document.getElementById('subtotal').textContent = `‚Çπ${subtotal.toFixed(2)}`;
      document.getElementById('tax').textContent = `‚Çπ${tax.toFixed(2)}`;
      document.getElementById('shipping').textContent = `‚Çπ${shippingCost}`;
      document.getElementById('total').textContent = `‚Çπ${total.toFixed(2)}`;
      
      // Update QR amount
      document.getElementById('qr-amount').textContent = total.toFixed(2);
    }

    // Format card number with spaces
    function formatCardNumber(input) {
      let value = input.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
      let formattedValue = value.replace(/\d{4}(?=.)/g, '$& ');
      input.value = formattedValue;
    }

    // Format expiry date
    function formatExpiryDate(input) {
      let value = input.value.replace(/\D/g, '');
      if (value.length >= 2) {
        value = value.substring(0, 2) + '/' + value.substring(2, 4);
      }
      input.value = value;
    }

    // Validate form
    function validateForm() {
      const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked').value;
      let requiredFields = [
        'firstName', 'lastName', 'email', 'phone', 'address', 
        'city', 'state', 'zipCode', 'country'
      ];

      // Add card fields if card payment is selected
      if (paymentMethod === 'card') {
        requiredFields = requiredFields.concat(['cardNumber', 'expiryDate', 'cvv', 'cardName']);
      }

      let isValid = true;
      requiredFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (!field.value.trim()) {
          field.classList.add('error');
          isValid = false;
        } else {
          field.classList.remove('error');
        }
      });

      // Check terms checkbox
      const termsCheckbox = document.getElementById('terms');
      if (!termsCheckbox.checked) {
        termsCheckbox.classList.add('error');
        isValid = false;
      } else {
        termsCheckbox.classList.remove('error');
      }

      // Enable/disable place order button
      const placeOrderBtn = document.getElementById('place-order-btn');
      placeOrderBtn.disabled = !isValid || cart.length === 0;

      return isValid;
    }

    // Show notification
    function showNotification(message, type = 'success') {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.remove();
      }, 3000);
    }

    // Process order
    function processOrder() {
      if (!validateForm()) {
        showNotification('Please fill in all required fields', 'error');
        return;
      }

      // Show loading overlay
      document.getElementById('loading-overlay').style.display = 'flex';

      // Simulate order processing
      setTimeout(() => {
        // Hide loading overlay
        document.getElementById('loading-overlay').style.display = 'none';
        
        // Save order to localStorage
        const orderData = {
          id: Date.now().toString(),
          date: new Date().toISOString(),
          items: cart,
          subtotal: cart.reduce((total, item) => total + (item.price * item.quantity), 0),
          tax: cart.reduce((total, item) => total + (item.price * item.quantity), 0) * 0.18,
          shipping: shippingCost,
          total: cart.reduce((total, item) => total + (item.price * item.quantity), 0) * 1.18 + shippingCost,
          status: 'Delivered',
          paymentMethod: document.querySelector('input[name="paymentMethod"]:checked').value,
          shippingAddress: {
            firstName: document.getElementById('firstName').value,
            lastName: document.getElementById('lastName').value,
            email: document.getElementById('email').value,
            phone: document.getElementById('phone').value,
            address: document.getElementById('address').value,
            city: document.getElementById('city').value,
            state: document.getElementById('state').value,
            zipCode: document.getElementById('zipCode').value,
            country: document.getElementById('country').value
          }
        };
        
        // Get existing orders or create empty array
        const existingOrders = JSON.parse(localStorage.getItem('orders')) || [];
        existingOrders.unshift(orderData); // Add new order at the beginning
        localStorage.setItem('orders', JSON.stringify(existingOrders));
        
        // Clear cart
        localStorage.removeItem('cart');
        
        // Show success message
        showNotification('Order placed successfully! Redirecting to home...', 'success');
        
        // Redirect to index
        setTimeout(() => {
          window.location.href = './index.html';
        }, 2000);
      }, 3000);
    }

    // Event listeners
    document.addEventListener('DOMContentLoaded', function() {
      // Check if cart is empty
      if (cart.length === 0) {
        showNotification('Your cart is empty. Redirecting to shopping cart...', 'error');
        setTimeout(() => {
          window.location.href = './shopping-cart.html';
        }, 2000);
        return;
      }

      updateOrderSummary();

      // Back button
      document.getElementById('back-btn').addEventListener('click', function() {
        window.location.href = './shopping-cart.html';
      });

      // Card number formatting
      document.getElementById('cardNumber').addEventListener('input', function() {
        formatCardNumber(this);
      });

      // Expiry date formatting
      document.getElementById('expiryDate').addEventListener('input', function() {
        formatExpiryDate(this);
      });

      // CVV validation (numbers only)
      document.getElementById('cvv').addEventListener('input', function() {
        this.value = this.value.replace(/\D/g, '');
      });

      // Shipping option change
      document.querySelectorAll('input[name="shipping"]').forEach(radio => {
        radio.addEventListener('change', function() {
          switch(this.value) {
            case 'standard':
              shippingCost = 100;
              break;
            case 'express':
              shippingCost = 250;
              break;
            case 'overnight':
              shippingCost = 500;
              break;
          }
          document.getElementById('shipping').textContent = `‚Çπ${shippingCost}`;
          updateOrderSummary();
        });
      });

      // Payment method switching
      document.querySelectorAll('input[name="paymentMethod"]').forEach(radio => {
        radio.addEventListener('change', function() {
          const cardForm = document.getElementById('card-payment-form');
          const qrForm = document.getElementById('qr-payment-form');
          
          if (this.value === 'card') {
            cardForm.style.display = 'block';
            qrForm.style.display = 'none';
            // Make card fields required
            ['cardNumber', 'expiryDate', 'cvv', 'cardName'].forEach(fieldId => {
              const field = document.getElementById(fieldId);
              field.required = true;
            });
          } else {
            cardForm.style.display = 'none';
            qrForm.style.display = 'block';
            // Remove required from card fields
            ['cardNumber', 'expiryDate', 'cvv', 'cardName'].forEach(fieldId => {
              const field = document.getElementById(fieldId);
              field.required = false;
            });
          }
          validateForm();
        });
      });

      // Check payment status button
      document.getElementById('check-payment-btn').addEventListener('click', function() {
        const statusIndicator = document.querySelector('.status-indicator');
        const statusIcon = document.querySelector('.status-icon');
        const statusText = document.querySelector('.status-text');
        
        // Simulate checking payment status
        statusIcon.textContent = 'üîÑ';
        statusText.textContent = 'Checking payment...';
        
        setTimeout(() => {
          // Simulate successful payment (in real app, this would check actual payment status)
          statusIcon.textContent = '‚úÖ';
          statusText.textContent = 'Payment successful!';
          statusText.style.color = '#28a745';
          
          // Enable place order button
          document.getElementById('place-order-btn').disabled = false;
          showNotification('Payment verified successfully!', 'success');
        }, 2000);
      });

      // Form validation on input
      document.querySelectorAll('input, select, textarea').forEach(field => {
        field.addEventListener('input', validateForm);
        field.addEventListener('change', validateForm);
      });

      // Terms checkbox
      document.getElementById('terms').addEventListener('change', validateForm);

      // Place order button
      document.getElementById('place-order-btn').addEventListener('click', processOrder);
    });
  </script>
</body>
</html> 