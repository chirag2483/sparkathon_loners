<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Room</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" type="text/css" media="screen" href="css/main.css" />
    <link
      rel="stylesheet"
      type="text/css"
      media="screen"
      href="css/lobby.css"
    />
  </head>
  <body>
    <header id="nav">
      <div class="nav--list">
        <a href="lobby.html">
          <h3 id="logo">
            <img src="assets/Images/walmart-logo.png" alt="Walmart Logo" />
            <span>Wally-verse</span>
          </h3>
        </a>
      </div>

      <div id="nav__links">
        <a class="nav__link" href="/">
          Lobby
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="#ede0e0"
            viewBox="0 0 24 24"
          >
            <path
              d="M20 7.093v-5.093h-3v2.093l3 3zm4 5.907l-12-12-12 12h3v10h7v-5h4v5h7v-10h3zm-5 8h-3v-5h-8v5h-3v-10.26l7-6.912 7 6.99v10.182z"
            />
          </svg>
        </a>
        <button class="nav__link" id="create__room__btn">
          Custom Room
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="#ede0e0"
            viewBox="0 0 24 24"
          >
            <path
              d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6 13h-5v5h-2v-5h-5v-2h5v-5h2v5h5v2z"
            />
          </svg>
        </button>
        <button id="cart-btn" class="nav__link" style="display: inline-block !important; visibility: visible !important; opacity: 1 !important; background: white !important; color: #1e1e1e !important; border: 2px solid #00b4d8 !important; padding: 10px 15px !important; border-radius: 8px !important; margin-right: 15px !important; font-weight: bold !important;">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#1e1e1e" viewBox="0 0 24 24">
            <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
          </svg>
          Cart
        </button>
        <button id="user-login" style="display: none;">Login</button>
        <button id="user-logout" style="display: none;">Logout</button>
      </div>
      </div>
    </header>

    <main id="room__lobby__container">
      <div id="form__container">
        <div id="form__container__header">
          <p>Create a custom Room</p>
        </div>

        <form id="lobby__form">
          <div class="form__field__wrapper">
            <label>Room Name</label>
            <input
              type="text"
              name="room"
              required
              placeholder="Enter room name..."
            />
          </div>

          <div class="form__field__wrapper">
            <button type="submit">
              Create custom room
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
              >
                <path
                  d="M13.025 1l-2.847 2.828 6.176 6.176h-16.354v3.992h16.354l-6.176 6.176 2.847 2.828 10.975-11z"
                />
              </svg>
            </button>
          </div>
        </form>
      </div>
    </main>

    <main id="room__lobby-container">
      <div data-room="General" class="room__lobby-holders room__lobby-main">
        General
      </div>
      <div id="shopping-room" data-room="Shopping" class="room__lobby-holders">
        Shopping
        <div class="premium-badge">Premium</div>
      </div>
      <div data-room="Trading" class="room__lobby-holders">Trading</div>
      <div id="metaverse-room" data-room="Metaverse" class="room__lobby-holders">
        Metaverse
        <div class="premium-badge">Premium</div>
      </div>
      <div data-room="Crypto" class="room__lobby-holders">Crypto & NFT</div>
    </main>
    
    <div id="login-prompt" style="display: none; text-align: center; margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 10px;">
      <h3>ðŸ”’ Premium Features</h3>
      <p>Login to access Virtual Tryon and 3D Shopping experiences!</p>
      <button onclick="document.getElementById('user-login').click()" style="background: #00b4d8; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;">
        Login Now
      </button>
    </div>
  </body>
  <script>
    const userLogin = document.getElementById("user-login");
    const userLogout = document.getElementById("user-logout");
    const cartBtn = document.getElementById("cart-btn");
    const shoppingRoom = document.getElementById("shopping-room");
    const metaverseRoom = document.getElementById("metaverse-room");
    const loginPrompt = document.getElementById("login-prompt");
    
    // Check if user is logged in
    const user = localStorage.getItem("user");
    console.log("User from localStorage:", user);
    console.log("Cart button element:", cartBtn);
    
    if (user) {
      // User is logged in
      userLogin.innerHTML = user;
      userLogin.style.display = "inline-block";
      userLogout.style.display = "inline-block";
      cartBtn.style.display = "inline-block";
      cartBtn.style.visibility = "visible";
      cartBtn.style.opacity = "1";
      console.log("Cart button should be visible now");
      
      // Show premium rooms for logged-in users
      shoppingRoom.style.display = "block";
      metaverseRoom.style.display = "block";
      
      // Hide login prompt for logged-in users
      loginPrompt.style.display = "none";
      
      console.log("User logged in - showing all rooms and cart button");
      
      // Add logout functionality
      userLogout.addEventListener("click", () => {
        localStorage.removeItem("user");
        window.location.href = "./index.html";
      });
      
      // Add cart functionality
      cartBtn.addEventListener("click", () => {
        window.location.href = "./shopping-cart.html";
      });
    } else {
      // User is not logged in
      userLogin.innerHTML = "Login";
      userLogin.style.display = "inline-block";
      userLogout.style.display = "none";
      // cartBtn.style.display = "none"; // Hide cart button when not logged in - TEMPORARILY COMMENTED FOR TESTING
      
      // Hide premium rooms for non-logged-in users
      shoppingRoom.style.display = "none";
      metaverseRoom.style.display = "none";
      
      // Show login prompt for premium features
      loginPrompt.style.display = "block";
      
      console.log("User not logged in - hiding premium rooms and cart button");
      
      // Add login functionality
      userLogin.addEventListener("click", () => {
        window.location.href = "./login.html";
      });
    }
    
    // FORCE CART BUTTON VISIBLE FOR TESTING
    cartBtn.style.display = "inline-block !important";
    cartBtn.style.visibility = "visible !important";
    cartBtn.style.opacity = "1 !important";
    console.log("Cart button forced visible for testing");
  </script>
  <script type="text/javascript" src="src/video/lobby.js"></script>
</html>
